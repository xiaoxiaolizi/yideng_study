<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <img src="" alt="" crossorigin="anonymous">
    <div id='showtxt'></div>

    <script>
        // 测试网速
        var filesize = 4;  //measured in KB 
        var arr=["网速低于50KB","网速在50-100KB之间","网速在100-200KB之间","网速在200-300KB之间","视频通讯"];
        var st = Date.now();
        console.log(st)
        var image = new Image();
        image.crossOrigin = "anonymous";
        image.src = "http://img1.imgtn.bdimg.com/it/u=3720541002,3553154861&fm=27&gp=0.jpg";//"qq.png"; // 1*1 3Kb
        image.onload = function() {
            var et = Date.now();
           // var w = 4 / (e - s)*1000; // 1-1000
            var speed = Math.round(filesize*1000)/(et - st);
            var scope=(speed>0 && speed<=50)?0:(speed>50 && speed<=100)?1:(speed>=100 && speed<200)?2:(speed>=200 && speed<300)?3:4;
            document.getElementById("showtxt").innerHTML = ("您的下载速度为：" + arr[scope] + " (K/秒)") 

            console.log(et);
            console.log(speed);
        }
        
        // 上报数据
        var image2 = new Image();
        image2.crossOrigin = "anonymous";
        image2.src = "http://img1.imgtn.bdimg.com/it/u=3720541002,3553154861&fm=27&gp=0.jpg?name=123"; 
       // console.log(image2)
    </script>
</body>
</html>